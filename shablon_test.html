<html><head><base href="https://proxy.example.com/">
<meta charset="UTF-8">
<title>ОРАКУЛ SHAMBALA</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&display=swap" rel="stylesheet">
<style>
	body {
    	font-family: 'Arial', sans-serif;
    	background-color: #1a1a1a;
    	color: #ffffff;
    	margin: 0;
    	padding: 20px;
    	min-height: 100vh;
    	display: flex;
    	flex-direction: column;
    	align-items: center;
	}
 
	.container {
    	max-width: 800px;
    	width: 100%;
    	background-color: #2d2d2d;
    	padding: 30px;
    	border-radius: 15px;
    	box-shadow: 0 0 20px rgba(0,0,0,0.5);
	}
 
	h1 {
    	text-align: center;
    	color: #9f86ff;
    	margin-bottom: 30px;
    	font-family: 'Cinzel', serif;
    	font-size: 2.5em;
    	text-shadow: 0 0 10px rgba(159, 134, 255, 0.5);
    	animation: titleGlow 2s ease-in-out infinite;
	}
 
	@keyframes titleGlow {
    	0% { text-shadow: 0 0 10px rgba(159, 134, 255, 0.5); }
    	50% { text-shadow: 0 0 20px rgba(159, 134, 255, 0.8); }
    	100% { text-shadow: 0 0 10px rgba(159, 134, 255, 0.5); }
	}
 
	.setup-form {
    	text-align: center;
    	margin-bottom: 30px;
	}
 
	.position-input {
    	padding: 10px;
    	font-size: 16px;
    	width: 80px;
    	background-color: #363636;
    	border: 2px solid #9f86ff;
    	color: white;
    	border-radius: 5px;
    	margin-right: 10px;
	}
 
	.result {
    	margin: 20px 0;
    	padding: 20px;
    	background-color: #363636;
    	border-radius: 10px;
    	display: none;
	}
 
	.position {
    	margin: 15px 0;
    	padding: 15px;
    	background-color: #404040;
    	border-radius: 8px;
    	border-left: 4px solid #9f86ff;
    	position: relative;
    	opacity: 1;
    	transform: translateY(0);
	}
 
	.position-hidden {
    	opacity: 0;
    	transform: translateY(20px);
    	transition: all 0.5s ease;
	}
 
	.card-hidden {
    	opacity: 0;
        transform: translateX(-20px);
	}
 
	.card-searching {
    	animation: searchingAnimation 0.5s ease infinite;
	}
 
	.card-revealed {
    	opacity: 1;
    	transform: translateX(0);
    	transition: all 0.5s ease;
	}
 
	@keyframes searchingAnimation {
    	0% { transform: translateX(-5px); }
    	50% { transform: translateX(5px); }
    	100% { transform: translateX(-5px); }
	}
 
	.generate-btn {
    	position: relative;
    	padding: 15px 30px;
    	font-size: 20px;
    	background: linear-gradient(45deg, #9f86ff, #7c5cff);
    	color: white;
    	border: none;
    	border-radius: 25px;
    	cursor: pointer;
    	transition: transform 0.2s;
    	overflow: hidden;
    	margin: 40px auto;
    	display: block;
    	font-family: 'Cinzel', serif;
    	font-weight: 700;
    	letter-spacing: 2px;
    	text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
    	animation: buttonPulse 2s infinite;
	}
 
	@keyframes buttonPulse {
    	0% { transform: scale(1); text-shadow: 0 0 5px rgba(255, 255, 255, 0.5); }
    	50% { transform: scale(1.05); text-shadow: 0 0 15px rgba(255, 255, 255, 0.8); }
    	100% { transform: scale(1); text-shadow: 0 0 5px rgba(255, 255, 255, 0.5); }
	}
 @keyframes fadeOutWithFlash {
    0% {
        transform: scale(1);
        opacity: 1;
        box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    }
    50% {
        transform: scale(1.2);
        box-shadow: 0 0 50px rgba(255, 255, 255, 0.8);
        opacity: 1;
    }
    100% {
        transform: scale(0.8);
        opacity: 0;
        box-shadow: 0 0 0 rgba(255, 255, 255, 0);
    }
}

.fade-out-flash {
    animation: fadeOutWithFlash 5.3s ease forwards;
}
	.category {
    	display: inline-block;
    	padding: 5px 10px;
    	margin: 3px;
    	border-radius: 15px;
    	font-size: 14px;
    	color: white; /* Add this to maintain text color for links */
    	text-decoration: none;
    	transition: transform 0.2s ease;
	}
 
	.category:hover {
    	transform: scale(1.05);
	}
 
	.direction {
    	background-color: #ff7676;
    	animation: pulsateRed 2s infinite;
	}
 
	.state {
    	background-color: #76ff76;
    	animation: pulsateGreen 2s infinite;
	}
 
	.message {
    	background-color: #7676ff;
    	animation: pulsateBlue 2s infinite;
	}
	
 
	.card-number {
    	font-weight: bold;
    	margin-left: 5px;
	}
 
	.card-type {
    	margin-left: 5px;
    	padding: 2px 6px;
    	border-radius: 10px;
    	font-size: 12px;
	}
 
	.positive {
    	background-color: #006400;
    	color: white;
	}
 
	.negative {
    	background-color: #ff0000;
    	color: white;
	}
 
	@keyframes pulsateRed {
    	0% { box-shadow: 0 0 5px #ff7676; }
    	50% { box-shadow: 0 0 15px #ff7676; }
    	100% { box-shadow: 0 0 5px #ff7676; }
	}
 
	@keyframes pulsateGreen {
    	0% { box-shadow: 0 0 5px #76ff76; }
    	50% { box-shadow: 0 0 15px #76ff76; }
    	100% { box-shadow: 0 0 5px #76ff76; }
	}
 
	@keyframes pulsateBlue {
    	0% { box-shadow: 0 0 5px #7676ff; }
    	50% { box-shadow: 0 0 15px #7676ff; }
    	100% { box-shadow: 0 0 5px #7676ff; }
	}
 
	.error {
    	color: #ff7676;
    	margin-top: 10px;
    	display: none;
	}
 
	.flash {
    	position: absolute;
    	top: 0;
    	left: 0;
    	right: 0;
    	bottom: 0;
    	background: white;
    	opacity: 0;
    	pointer-events: none;
    	animation: flashAnimation 1s ease-out;
	}
 
	@keyframes flashAnimation {
    	0% { opacity: 0; }
    	50% { opacity: 0.5; }
    	100% { opacity: 0; }
	}
 
	.position-title {
    	display: inline-block;
    	animation: titleReveal 0.5s ease;
	}
 
	@keyframes titleReveal {
    	from {
        	opacity: 0;
        	transform: translateY(-10px);
    	}
    	to {
        	opacity: 1;
        	transform: translateY(0);
    	}
	}
 
	@media (max-width: 600px) {
    	.container {
        	padding: 15px;
    	}
    	
    	.position {
        	padding: 10px;
        	margin: 10px 0;
    	}
    	
    	.category {
        	font-size: 12px;
        	padding: 4px 8px;
    	}
 
    	h1 {
        	font-size: 2em;
    	}
	}
</style>
</head>
<body>
	<div class="container">
    	<h1>ОРАКУЛ SHAMBALA</h1>
    	
    	<div class="setup-form">
        	<label for="positionCount">Количество позиций 1:</label>
        	<input type="number" id="positionCount" class="position-input" min="1" max="2" value="1">
	        <div id="error" class="error">В тестовом режиме доступен выбор только 1 позиции карт</div>
    	</div>
 
    	<div id="result" class="result"></div>
    	<button id="generateBtn" class="generate-btn">ВЫДАТЬ РАСКЛАД</button>
	</div>
 
  <script>
	function getRandomCards() {
    	const categories = [
        	{
            	name: "НАПРАВЛЕНИЕ",
            	cards: Object.keys(directionCardLinks),
            	class: "direction"
        	},
        	{
            	name: "СОСТОЯНИЕ",
            	cards: Object.keys(stateCardLinks),
            	class: "state"
        	},
        	{
            	name: "ПОСЛАНИЕ",
            	cards: Object.keys(messageCardLinks),
            	class: "message"
        	}
    	];
 
    	const selectedCategories = [];
    	const randomCardCount = Math.floor(Math.random() * 3) + 1;
 
    	while (selectedCategories.length < randomCardCount) {
        	const randomCategoryIndex = Math.floor(Math.random() * categories.length);
        	const category = categories[randomCategoryIndex];
        	if (!selectedCategories.includes(category)) {
                selectedCategories.push(category);
        	}
    	}
 
    	return selectedCategories.map(category => {
        	const randomIndex = Math.floor(Math.random() * category.cards.length);
        	const displayName = category.cards[randomIndex];
        	
        	return {
            	name: category.name,
            	displayName: displayName,
            	class: category.class,
            	isPositive: Math.random() >= 0.5
        	};
    	});
	}
 
 
    	function animateButton() {
        	const btn = document.getElementById('generateBtn');
        	btn.style.transform = 'scale(0.95)';
        	btn.style.opacity = '0.9';
        	setTimeout(() => {
            	btn.style.transform = 'scale(1)';
            	btn.style.opacity = '1';
        	}, 200);
    	}
 
    	const directionCardLinks = {
        	"Весы": " aHR0cHM6Ly9heGlvbWF0aWMtYm9iY2F0LTQwZi5ub3Rpb24uc2l0ZS8xMWM0NzViYzlhN2Q4MTRlYmMyYmY1OGY2YTFjNjY4ZD9wdnM9NA=="
        	
    	};
 
    	const stateCardLinks = {
        	"вина": "aHR0cHM6Ly9ncmFuaXRlLWJsYW5rZXQtZWZlLm5vdGlvbi5zaXRlLzg0OGFhZTBiZjQyZDQ0Mjc5MDRmYWQ2MjRkMDk3ZjRiP3B2cz00",
        
    	};
 
	    const messageCardLinks = {
        	"Судьбоносный день": "aHR0cHM6Ly9jb2hlcmVudC1tdXNjbGUtN2IwLm5vdGlvbi5zaXRlLzEwOTFiZDYzYzkxYTgwNmJhMDc0ZjM2NzE5NWE2YzVkP3B2cz00",
        	
        	
    	};
 
    	function decryptLink(encodedLink) {
        	try {
            	return atob(encodedLink);
        	} catch (e) {
            	console.error('Failed to decrypt link:', e);
            	return '#';
        	}
    	}
 
    	function getCardLink(category, cardName) {
        	let encodedLink;
        	if (category === "НАПРАВЛЕНИЕ") {
            	encodedLink = directionCardLinks[cardName];
        	} else if (category === "СОСТОЯНИЕ") {
            	encodedLink = stateCardLinks[cardName];
        	} else if (category === "ПОСЛАНИЕ") {
            	encodedLink = messageCardLinks[cardName];
        	}
        	return encodedLink ? decryptLink(encodedLink) : '#';
    	}
 
    	async function generateReading() {
        	const positionCount = parseInt(document.getElementById('positionCount').value);
        	const error = document.getElementById('error');
        	
        	if (positionCount < 1 || positionCount > 1 || isNaN(positionCount)) {
            	error.style.display = 'block';
            	return;
        	}
        	
        	error.style.display = 'none';
        	const result = document.getElementById('result');
        	result.style.display = 'block';
        	result.innerHTML = '';
 
        	for(let i = 0; i < positionCount; i++) {
            	const positionDiv = document.createElement('div');
            	positionDiv.className = 'position position-hidden';
            	
            	const cards = getRandomCards();
            	let html = `<strong class="position-title">Позиция ${i + 1}:</strong><br>`;
            	
            	cards.forEach(card => {
                	html += `
                    	<a href="${getCardLink(card.name, card.displayName)}" target="_blank" class="category ${card.class} card-hidden" style="text-decoration: none; cursor: pointer">
                        	${card.name}
                        	<span class="card-number">${card.displayName}</span>
                        	<span class="card-type ${card.isPositive ? 'positive' : 'negative'}">
                                ${card.isPositive ? 'позитив' : 'негатив'}
                        	</span>
                    	</a> `;
            	});
            	
            	positionDiv.innerHTML = html;
            	result.appendChild(positionDiv);
            	
            	await new Promise(resolve => setTimeout(resolve, 500));
                positionDiv.classList.remove('position-hidden');
            	
            	const flash = document.createElement('div');
            	flash.className = 'flash';
            	positionDiv.appendChild(flash);
            	
            	const cardElements = positionDiv.querySelectorAll('.category');
   	         for(let card of cardElements) {
                	await new Promise(resolve => {
                    	setTimeout(() => {
                            card.classList.add('card-searching');
                        	setTimeout(() => {
    	                        card.classList.remove('card-searching');
                                card.classList.remove('card-hidden');
                                card.classList.add('card-revealed');
                            	resolve();
     	                   }, 2000);
                    	}, 100);
                	});
            	}
            	
            	setTimeout(() => flash.remove(), 1000);
            	await new Promise(resolve => setTimeout(resolve, 500));
   	     }
    	}
 
    	const generateBtn = document.getElementById('generateBtn');
    	const positionInput = document.getElementById('positionCount');
 
   generateBtn.addEventListener('click', () => {
    animateButton(); // Существующая функция анимации кнопки
    generateReading(); // Генерация расклада

    // Добавить класс для анимации вспышки и исчезновения
    generateBtn.classList.add('fade-out-flash');

    // Удалить кнопку из DOM после завершения анимации
    setTimeout(() => generateBtn.remove(), 1000); // 1 секунда — это длительность анимации
});
 
    	positionInput.addEventListener('input', () => {
        	const value = parseInt(positionInput.value);
        	if (value < 1 || value > 12 || isNaN(value)) {
                document.getElementById('error').style.display = 'block';
            	generateBtn.disabled = true;
        	} else {
                document.getElementById('error').style.display = 'none';
            	generateBtn.disabled = false;
        	}
    	});
    </script>
</body></html>
